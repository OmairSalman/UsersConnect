{{#if posts.length}}
  {{#if (gt 2 page)}}
    <h1 class="text-center my-4">Welcome to your feed, {{#if currentUser.isAdmin}}Admin {{/if}}{{currentUser.name}}</h1>
  {{/if}}
{{/if}}

<div class="create-post-container">
  {{! MODIFY FORM - Add enctype }}
  <form action="/posts" method="POST" class="create-post-form" enctype="multipart/form-data">
    <div class="form-group">
      <label for="title">Title</label>
      <input 
        type="text" 
        id="title" 
        name="title" 
        class="form-input" 
        placeholder="Enter your post title" 
        required
      >
    </div>

    <div class="form-group">
      <label for="content">Content</label>
      <textarea 
        id="content" 
        name="content" 
        rows="6" 
        class="form-textarea" 
        placeholder="Write your post here..."
        required
      ></textarea>
    </div>

    {{! ADD THIS NEW FIELD }}
    <div class="form-group">
      <label for="image">Image (optional)</label>
      <input 
        type="file" 
        id="image" 
        name="image" 
        class="form-control" 
        accept="image/*"
      >
      <small class="form-text text-muted">Max size: 5MB. Supported: JPG, PNG, GIF</small>
    </div>

    <button class="btn btn-primary" type="submit">Publish</button>
  </form>
</div>

<div class="feed-container" id="feed-container"
  data-page="{{page}}" 
  data-limit="{{limit}}" 
  data-total-pages="{{totalPages}}">
  {{#if posts.length}}
    {{#each posts}}
      {{> postCard post=this currentUser=../currentUser}}
    {{/each}}
  {{else}}
    <div class="feed-empty-message d-flex flex-column justify-content-center align-items-center" style="min-height: 60vh;">
      <span class="display-4 fw-bold mb-3">No posts yet.</span>
      <span class="h4 text-muted">Be the first to post!</span>
    </div>
  {{/if}}
</div>

<!-- pagination UI -->
<nav id="pagination" aria-label="Page navigation" class="mt-3">
  {{#if (gt totalPages 1)}}
    <ul class="pagination justify-content-center">
      {{#if (gt page 1)}}
        <li class="page-item"><a class="page-link" href="/feed?page={{subtract page 1}}">Previous</a></li>
      {{/if}}
      {{#each (range 1 totalPages)}}
        <li class="page-item"><a class="page-link {{#if (eq ../page this)}}active{{/if}}" href="/feed?page={{this}}">{{this}}</a></li>
      {{/each}}
      {{#if (lt page totalPages)}}
        <li class="page-item"><a class="page-link" href="/feed?page={{add page 1}}">Next</a></li>
      {{/if}}
    </ul>
  {{/if}}
</nav>